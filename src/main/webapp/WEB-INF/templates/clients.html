<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="bg-gray-100">
  <head>
    <title>Liste des Clients</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
  </head>
  <body>
    <main class="container mx-auto px-4 py-8" x-data="{ showCreateModal: false }">
      <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">
        Liste des Clients
      </h1>

      <div class="flex justify-between items-center mb-6">
        <button
          @click="showCreateModal = true"
          class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-110"
        >
          <i class="fas fa-plus mr-2"></i> Ajouter un client
        </button>

        <form action="" method="get" class="flex items-center">
          <input
            type="text"
            name="search"
            value=""
            placeholder="Rechercher un Client..."
            class="px-4 py-2 border rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-300"
          />
          <button
            type="submit"
            class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-r-lg transition duration-300 ease-in-out"
          >
            <i class="fas fa-search mr-2"></i> Rechercher
          </button>
        </form>
        <a
          href="./clients"
          class="w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-orange-600 focus:ring-offset-2"
        >
          Tous les clients
        </a>
      </div>

      <div class="overflow-x-auto bg-white shadow-md rounded-lg">
        <table class="min-w-full table-auto">
          <thead class="bg-blue-300">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Nom
              </th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Prenom
              </th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Email
              </th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Adresse de Livraison
              </th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Moyen Paiement
              </th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                Action
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr
              th:each="client : ${clients}"
              class="hover:bg-blue-100"
            >
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${client.nom}"></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${client.prenom}"></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${client.email}"></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${client.adresselivraison}"></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${client.moyenpaiement}"></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
  <div class="flex space-x-2">
    <form action="" method="POST" onsubmit="return confirm('vous etes sur que vous voullez supprimer ce client?');">
      <input type="hidden" name="action" value="delete">
      <input type="hidden" name="clientId" th:value="${client.id}">
      <button
        type="submit"
        class="text-white hover:text-white bg-red-500 hover:bg-red-200 p-2 rounded-full transition duration-300 ease-in-out"
      >
        <i class="fas fa-trash-alt"></i>
      </button>
    </form>
  </div>
</td>

            </tr>
          </tbody>
        </table>
      </div>

   <!-- Pagination -->
<div class="mt-6 flex justify-center items-center space-x-2">
  <div class="flex space-x-3">
    <th:block th:each="pageNum : ${#numbers.sequence(1, totalPages)}">
      <a
        th:if="${pageNum == 1 || pageNum == totalPages || (pageNum >= currentPage - 1 && pageNum <= currentPage + 1)}"
        th:href="@{/clients(page=${pageNum})}"
        th:text="${pageNum}"
        th:classappend="${pageNum == currentPage} ? 'bg-blue-600 text-white' : 'bg-white text-blue-600 hover:bg-blue-100'"
        class="px-4 py-2 font-semibold rounded-lg shadow-md transition duration-300 ease-in-out"
      ></a>
      <span
        th:if="${pageNum == currentPage - 2 || pageNum == currentPage + 2}"
        class="px-2 py-1 text-gray-500"
      >
        ...
      </span>
    </th:block>
  </div>
</div>


      <!-- Modal de crÃ©ation -->
      <div
        x-show="showCreateModal"
        class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"
        x-cloak
      >
        <div
          class="relative top-20 mx-auto p-5 border w-[50%] shadow-lg rounded-md bg-white"
        >
          <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">
              Ajouter un nouveau client
            </h3>
<form id="create-client-form" action="" method="POST">
              <input type="hidden" name="action" value="create" />
              <div class="mt-2 px-7 py-3 grid grid-cols-2 gap-4">
                <div class="mb-3">
                  <label
                    for="create-nom"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Nom</label>
                  <input
                    id="create-nom"
                    type="text"
                    name="nom"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="Nom du client"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label
                    for="create-nom"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Prenom</label
                  >
                  <input
                    id="create-prenom"
                    type="text"
                    name="prenom"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="Prenom du client"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label
                    for="create-email"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Email</label
                  >
                 
                  <input
                    id="create-email"
                    type="text"
                    name="email"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="email"
                    step="0.01"
                    required
                  />
                </div>
                                <div class="mb-3">
                
                <label
                    for="create-motpasse"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Mot de passe</label
                  >
                  <input
                    id="create-motpasse"
                    type="password"
                    name="motpasse"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="Mot de passe"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label
                    for="create-adresselivraison"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Adresse de livraison</label
                  >
                  <input
                    id="create-adresselivraison"
                    type="text"
                    name="adresselivraison"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="Adresse de livraison"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label
                    for="create-moyenpaiment"
                    class="block text-sm font-medium text-gray-700 text-left mb-1"
                    >Moyen de paiement</label
                  >
                  <input
                    id="create-moyenpaiment"
                    type="text"
                    name="moyenpaiment"
                    class="px-3 py-2 border rounded-lg w-full"
                    placeholder="Moyen de paiement"
                    required
                  />
                </div>
              <div class="items-center flex gap-2 px-4 py-3">
                <button
                  type="button"
                  @click="showCreateModal = false"
                  id="annuler"
                  class="px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-600"
                >
                  Annuler
                </button>
                <button
                  type="submit"
                  class="px-4 py-2 bg-blue-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300"
                >
                  Ajouter
                </button>
              </div>
                            </div>
            </form>
          </div>
        </div>
      </div>
      
      
    </main>
    
    <script>
    openDeleteModal(event) {
        const button = event.target.closest("button");
        this.currentProduct = {
            id: button.getAttribute("data-id"),
            nom: button.getAttribute("data-nom"),
        };
        this.showDeleteModal = true;
    }
    </script>
    
  </body>
</html>
